<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Computer Vision Project • Human Detection & Targeting | پروژه بینایی کامپیوتر</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet" type="text/css" />
  <style>
    :root{--glass-bg:rgba(255,255,255,.08);--glass-bd:rgba(255,255,255,.18)}
    html,body{height:100%}
    body{
      color:#f1f5f9; 
      background:#0f1226; 
      overflow-x:hidden;
      font-family: 'Vazir', Tahoma, sans-serif;
      }
    
    /* Animated background */
    .bg-animated{position:fixed; inset:0; z-index:-2;
      background: radial-gradient(1200px 800px at 10% 10%, #6ee7ff11 0%, transparent 60%),
                  radial-gradient(900px 700px at 90% 20%, #ff71ce18 0%, transparent 60%),
                  radial-gradient(700px 600px at 10% 90%, #28f09c15 0%, transparent 60%),
                  linear-gradient(135deg,#0e0b30 0%,#050510 100%);
      filter:saturate(1.2) contrast(1.05);}
    .bg-animated::after{content:""; position:absolute; inset:-10%;
      background: conic-gradient(from 0deg, #8b5cf6 0%, #06b6d4 25%, #22d3ee 35%, #10b981 55%, #f43f5e 75%, #8b5cf6 100%);
      mix-blend-mode: screen; opacity:.12; animation: spin 28s linear infinite;
      filter: blur(80px);}
    @keyframes spin{to{transform:rotate(360deg)}}
    
    .glass{background:var(--glass-bg); border:1px solid var(--glass-bd); backdrop-filter: blur(10px); box-shadow:0 10px 30px rgba(0,0,0,.35);}
    .brand-grad{background:linear-gradient(90deg,#60a5fa,#22d3ee,#34d399); -webkit-background-clip:text; background-clip:text; color:transparent}
    .vignette::after{content:""; position:fixed; inset:0; z-index:-1; pointer-events:none; box-shadow:inset 0 0 200px 120px rgba(0,0,0,.55)}
    
    [dir="rtl"] {font-feature-settings:"kern" 1}
    section{padding: min(10vh,6rem) 0}
    .nav-pills .nav-link{color:#cbd5e1}
    .nav-pills .nav-link.active{color:#0b1220; background:linear-gradient(90deg,#22d3ee,#34d399)}
  </style>
</head>
<body class="vignette">
  <div class="bg-animated"></div>

  <!-- NAVBAR -->
  <nav class="navbar navbar-expand-lg navbar-dark" style="background:transparent">
    <div class="container">
      <a class="navbar-brand fw-bold" href="#"><i class="bi bi-bullseye"></i> CV Target</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#nav"><span class="navbar-toggler-icon"></span></button>
      <div class="collapse navbar-collapse" id="nav">
        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
          <li class="nav-item"><a class="nav-link" href="#features"><i class="bi bi-stars"></i> Features</a></li>
          <li class="nav-item"><a class="nav-link" href="#tech"><i class="bi bi-cpu"></i> Technologies</a></li>
          <li class="nav-item"><a class="nav-link" href="#get-started"><i class="bi bi-rocket-takeoff"></i> Start</a></li>
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown">Language</a>
            <ul class="dropdown-menu dropdown-menu-end">
              <li><a class="dropdown-item" href="#" onclick="showLang('fa')">فارسی</a></li>
              <li><a class="dropdown-item" href="#" onclick="showLang('en')">English</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <!-- HERO -->
  <header class="container py-5">
    <div class="row align-items-center g-4">
      <div class="col-12 col-lg-7">
        <div class="glass rounded-4 p-4 p-md-5">
          <ul class="nav nav-pills gap-2 mb-4">
            <li class="nav-item"><button class="nav-link active" onclick="showLang('fa')">فارسی</button></li>
            <li class="nav-item"><button class="nav-link" onclick="showLang('en')">English</button></li>
          </ul>
          <div id="fa" class="lang active" dir="rtl">
            <h1 class="display-6 fw-bold mb-3">پروژه <span class="brand-grad">بینایی کامپیوتر</span></h1>
            <p class="lead mb-4">تشخیص انسان در تصاویر و <span class="fw-semibold">شلیک به سمت هدف</span> با اتصال مستقیم به یونیتی و امنیت کامل محیط آزمایش.</p>
          </div>
          <div id="en" class="lang" dir="ltr" style="display:none;">
            <h1 class="display-6 fw-bold mb-3">Computer Vision <span class="brand-grad">Project</span></h1>
            <p class="lead mb-4">Human detection in images with intelligent <span class="fw-semibold">targeting & firing</span> integrated safely with Unity game engine.</p>
          </div>
        </div>
      </div>
      <div class="col-12 col-lg-5">
        <div class="glass rounded-4 p-4 p-md-5 h-100">
          <h2 class="h4 mb-3"><i class="bi bi-camera-video"></i> Live Preview</h2>
          <!-- <div class="d-grid gap-2 mb-3">
            <button id="btnWebcam" class="btn btn-outline-light btn-lg"><i class="bi bi-camera-video"></i> Use Webcam</button>
          </div> -->
          <!-- <div class="ratio ratio-16x9 rounded-3 overflow-hidden" style="background:#0b1024;border:1px dashed #3b3f55">
            <video id="video" autoplay playsinline style="width:100%;height:100%;object-fit:cover;display:none;"></video>
            <canvas id="canvas" style="width:100%;height:100%;"></canvas>
          </div> -->
          <div class="d-grid gap-2 mb-3" style="display:none;">
            <button id="toggleVideoStatus" class="btn btn-outline-light btn-lg"><i class="bi bi-camera-video"></i> Use Webcam</button>
          </div>
          <div class="ratio ratio-16x9 rounded-3 overflow-hidden" id="videoContainer" style="display:none;">
            <img src="/video_feed" style="width:100%; height:100%; object-fit:cover;">
          </div>
          <div class="mt-3 text-center" id="statusContainer">
            <p class="text-success fw-bold">Status: <span id="statusText" class="text-info fw-bold">UNKNOWN</span></p>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- FEATURES -->
  <section id="features">
    <div class="container">
      <div class="row g-4 text-center mb-4">
        <h2 class="fw-bold">Features • قابلیت‌ها</h2>
      </div>
      <div class="row g-4">
        <div class="col-md-4">
          <div class="glass rounded-4 p-4 h-100">
            <i class="bi bi-bounding-box-circles fs-2 mb-2"></i>
            <h5>Detection</h5>
            <p>Real-time human detection using YOLO/SSD models with confidence threshold and NMS options.</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="glass rounded-4 p-4 h-100">
            <i class="bi bi-crosshair fs-2 mb-2"></i>
            <h5>Targeting</h5>
            <p>Smart aim calculation and region-of-interest prioritization for Unity integration.</p>
          </div>
        </div>
        <div class="col-md-4">
          <div class="glass rounded-4 p-4 h-100">
            <i class="bi bi-shield-lock fs-2 mb-2"></i>
            <h5>Safety</h5>
            <p>Virtual firing simulation ensures secure testing without real-life hazards.</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TECHNOLOGIES -->
  <section id="tech">
    <div class="container text-center">
      <h2 class="fw-bold mb-4">Technologies • تکنولوژی‌ها</h2>
      <div class="row g-4 justify-content-center">
        <div class="col-md-3">
          <div class="glass rounded-4 p-4">
            <i class="bi bi-camera-video fs-1 mb-2"></i>
            <p>Webcam & Video Processing</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="glass rounded-4 p-4">
            <i class="bi bi-cpu fs-1 mb-2"></i>
            <p>Machine Learning Models (YOLO/SSD)</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="glass rounded-4 p-4">
            <i class="bi bi-unity fs-1 mb-2"></i>
            <p>Unity Game Engine Integration</p>
          </div>
        </div>
        <div class="col-md-3">
          <div class="glass rounded-4 p-4">
            <i class="bi bi-server fs-1 mb-2"></i>
            <p>Flask Backend & JSON API</p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- GET STARTED -->
  <section id="get-started">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-lg-10">
          <div class="glass rounded-4 p-4 p-md-5">
            <div class="row g-4 align-items-center">
              <div class="col-md-7" dir="rtl">
                <h3 class="fw-bold mb-2">شروع سریع</h3>
                <ol>
                  <li>نصب وابستگی‌ها و اجرای سرور Flask</li>
                  <li>بارگذاری مدل تشخیص (YOLO/SSD)</li>
                  <li>اتصال وب‌کم یا آپلود تصویر و مشاهده خروجی</li>
                  <li>ارسال داده به یونیتی برای شروع شلیک</li>
                </ol>
              </div>
              <div class="col-md-5" dir="ltr">
                <h3 class="fw-bold mb-2">Quick Start</h3>
                <ol>
                  <li>Install dependencies & run Flask server</li>
                  <li>Load detection model (YOLO/SSD)</li>
                  <li>Connect webcam or upload an image</li>
                  <li>Send detection JSON to Unity for firing</li>
                </ol>
              </div>
            </div>
            <div class="text-center mt-4">
              <a class="btn btn-lg btn-light text-dark fw-semibold" href="#"><i class="bi bi-journal-code"></i> Documentation</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- FOOTER -->
  <footer class="py-5 text-center text-secondary">
    <div class="small">© <span id="year"></span> CV Target • Built with Bootstrap</div>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script>
    document.getElementById('year').textContent = new Date().getFullYear();
    function showLang(lang){
      document.querySelectorAll('.lang').forEach(e => e.style.display='none');
      document.getElementById(lang).style.display='block';
    }
  </script>

  <script>
  document.getElementById('year').textContent = new Date().getFullYear();

function showLang(lang){
  // 
  document.querySelectorAll('.lang').forEach(e => e.style.display='none');
  // 
  document.getElementById(lang).style.display='block';

  // Nav Pills
  const navButtons = document.querySelectorAll('.nav-pills .nav-link');
  navButtons.forEach(btn => btn.classList.remove('active'));

  if(lang === 'fa'){
    navButtons[0].classList.add('active');  
  } else {
    navButtons[1].classList.add('active');  
  }

  // Dropdown language
  const dropdownItems = document.querySelectorAll('.dropdown-menu .dropdown-item');
  dropdownItems.forEach(item => item.classList.remove('active'));

  if(lang === 'fa'){
    dropdownItems[0].classList.add('active');
  } else {
    dropdownItems[1].classList.add('active');
  }
}

  // webcam
  const btnWebcam = document.getElementById("btnWebcam");
  const video = document.getElementById("video");
  const canvas = document.getElementById("canvas");
  const ctx = canvas.getContext("2d");

  btnWebcam.addEventListener("click", () => {
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
        video.style.display = "block";
        canvas.style.display = "none";
        video.play();
      })
      .catch(err => {
        alert("دسترسی به دوربین امکان‌پذیر نیست: " + err);
      });
  });


</script>
<script>
document.addEventListener("DOMContentLoaded", () => {
    function showStatusAlert() {
        fetch("/status")
        .then(res => res.json())
        .then(data => {
            console.log("Status:", data.status); 
            statusText.textContent = data.status;
        })
        .catch(err => console.log("Error fetching status:", err));
    }

    setInterval(showStatusAlert, 1000);
});
</script>
<script>
const toggleBtn = document.getElementById("toggleVideoStatus");
const videoDiv = document.getElementById("videoContainer");
const statusDiv = document.getElementById("statusContainer");

toggleBtn.addEventListener("click", () => {
  if (videoDiv.style.display === "none") {
    videoDiv.style.display = "block";
    statusDiv.style.display = "block";
    // toggleBtn.textContent = "مخفی کردن ویدیو و استاتوس";
  } else {
    videoDiv.style.display = "none";
    statusDiv.style.display = "none";
    // toggleBtn.textContent = "نمایش ویدیو و استاتوس";
  }
});
</script>
</body>
</html>
